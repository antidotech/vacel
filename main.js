!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const s=Symbol("Comlink.proxy"),r=Symbol("Comlink.endpoint"),a=Symbol("Comlink.releaseProxy"),i=new WeakSet,o=new Map([["proxy",{canHandle:e=>e&&e[s],serialize(e){const{port1:t,port2:n}=new MessageChannel;return function e(t,n=self){n.addEventListener("message",(function r(a){if(!a||!a.data)return;const{id:o,type:c,path:u}=Object.assign({path:[]},a.data),d=(a.data.argumentList||[]).map(p);let f;try{const n=u.slice(0,-1).reduce((e,t)=>e[t],t),r=u.reduce((e,t)=>e[t],t);switch(c){case 0:f=r;break;case 1:n[u.slice(-1)[0]]=p(a.data.value),f=!0;break;case 2:f=r.apply(n,d);break;case 3:f=function(e){return Object.assign(e,{[s]:!0})}(new r(...d));break;case 4:{const{port1:n,port2:s}=new MessageChannel;e(t,s),f=function(e,t){return h.set(e,t),e}(n,[n])}break;case 5:f=void 0}}catch(e){f=e,i.add(e)}Promise.resolve(f).catch(e=>(i.add(e),e)).then(e=>{const[t,s]=v(e);n.postMessage(Object.assign(Object.assign({},t),{id:o}),s),5===c&&(n.removeEventListener("message",r),l(n))})})),n.start&&n.start()}(e,t),[n,[n]]},deserialize:e=>(e.start(),c(e))}],["throw",{canHandle:e=>i.has(e),serialize(e){const t=e instanceof Error;let n=e;return t&&(n={isError:t,message:e.message,stack:e.stack}),[n,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error,e);throw e}}]]);function l(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function c(e,t){return function e(t,n=[],s=function(){}){let i=!1;const o=new Proxy(s,{get(s,r){if(u(i),r===a)return()=>f(t,{type:5,path:n.map(e=>e.toString())}).then(()=>{l(t),i=!0});if("then"===r){if(0===n.length)return{then:()=>o};const e=f(t,{type:0,path:n.map(e=>e.toString())}).then(p);return e.then.bind(e)}return e(t,[...n,r])},set(e,s,r){u(i);const[a,o]=v(r);return f(t,{type:1,path:[...n,s].map(e=>e.toString()),value:a},o).then(p)},apply(s,a,o){u(i);const l=n[n.length-1];if(l===r)return f(t,{type:4}).then(p);if("bind"===l)return e(t,n.slice(0,-1));const[c,h]=d(o);return f(t,{type:2,path:n.map(e=>e.toString()),argumentList:c},h).then(p)},construct(e,s){u(i);const[r,a]=d(s);return f(t,{type:3,path:n.map(e=>e.toString()),argumentList:r},a).then(p)}});return o}(e,[],t)}function u(e){if(e)throw new Error("Proxy has been released and is not useable")}function d(e){const t=e.map(v);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const h=new WeakMap;function v(e){for(const[t,n]of o)if(n.canHandle(e)){const[s,r]=n.serialize(e);return[{type:3,name:t,value:s},r]}return[{type:0,value:e},h.get(e)||[]]}function p(e){switch(e.type){case 3:return o.get(e.name).deserialize(e.value);case 0:return e.value}}function f(e,t,n){return new Promise(s=>{const r=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===r&&(e.removeEventListener("message",t),s(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:r},t),n)})}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class y extends HTMLElement{constructor(...e){super(...e),b(this,"textarea",null),b(this,"button",null),b(this,"onSourceUpdate",void 0),b(this,"onClick",async()=>{var e,t;return(null===(e=this.textarea)||void 0===e?void 0:e.value)&&(null===(t=this.onSourceUpdate)||void 0===t?void 0:t.call(this,this.textarea.value))}),b(this,"onInput",e=>{const{value:t}=e.target;localStorage.setItem("source",t)}),b(this,"onKeyDown",async({code:e,metaKey:t})=>{var n,s;return(null===(n=this.textarea)||void 0===n?void 0:n.value)&&"Enter"===e&&t&&(null===(s=this.onSourceUpdate)||void 0===s?void 0:s.call(this,this.textarea.value))})}get source(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.value}connectedCallback(){var e,t,n;this.textarea=this.querySelector("textarea"),this.button=this.querySelector("button"),null===(e=this.textarea)||void 0===e||e.addEventListener("input",this.onInput),null===(t=this.button)||void 0===t||t.addEventListener("click",this.onClick),this.addEventListener("keydown",this.onKeyDown);const s=null!==(n=atob(location.hash.slice(1)))&&void 0!==n?n:localStorage.getItem("source");console.log(s),this.textarea&&(this.textarea.value=s)}disconnectedCallback(){var e,t;null===(e=this.textarea)||void 0===e||e.removeEventListener("input",this.onInput),null===(t=this.querySelector("button"))||void 0===t||t.removeEventListener("click",this.onClick),this.removeEventListener("keydown",this.onKeyDown)}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends HTMLElement{constructor(...e){super(...e),m(this,"textarea",null),m(this,"buttons",{code:null,ast:null}),m(this,"type","code"),m(this,"result",void 0),m(this,"onResult",e=>{this.textarea&&(this.result=e,this.textarea.disabled=!1,"success"===e.type?(this.textarea.value="code"===this.type?e.code:JSON.stringify(e.ast,null,2),this.textarea.classList.add("is-success"),this.textarea.classList.remove("is-danger")):(this.textarea.value=e.message,this.textarea.classList.remove("is-success"),this.textarea.classList.add("is-danger")))}),m(this,"onClickCode",()=>{var e,t;this.type="code",null===(e=this.buttons.code)||void 0===e||e.classList.add("is-info","is-selected"),null===(t=this.buttons.ast)||void 0===t||t.classList.remove("is-info","is-selected"),this.result&&this.onResult(this.result)}),m(this,"onClickAST",()=>{var e,t;this.type="ast",null===(e=this.buttons.code)||void 0===e||e.classList.remove("is-info","is-selected"),null===(t=this.buttons.ast)||void 0===t||t.classList.add("is-info","is-selected"),this.result&&this.onResult(this.result)})}connectedCallback(){var e,t;this.textarea=this.querySelector("textarea"),this.buttons.code=this.querySelector("button[data-type=code]"),this.buttons.ast=this.querySelector("button[data-type=ast]"),null===(e=this.buttons.code)||void 0===e||e.addEventListener("click",this.onClickCode),null===(t=this.buttons.ast)||void 0===t||t.addEventListener("click",this.onClickAST)}disconnectedCallback(){var e,t;null===(e=this.buttons.code)||void 0===e||e.removeEventListener("click",this.onClickCode),null===(t=this.buttons.ast)||void 0===t||t.removeEventListener("click",this.onClickAST)}}const k=c(new Worker("/worker.js"));!function(){window.customElements.define("vaceline-source-panel",y),window.customElements.define("vaceline-result-panel",g);const e=document.querySelector("vaceline-source-panel"),t=document.querySelector("vaceline-result-panel");if(e&&t){var n;e.onSourceUpdate=async e=>t.onResult(await k(e)),null===(n=document.querySelector("button[data-share]"))||void 0===n||n.addEventListener("click",()=>{var t;location.hash=btoa(null!==(t=e.source)&&void 0!==t?t:"")})}}()}]);